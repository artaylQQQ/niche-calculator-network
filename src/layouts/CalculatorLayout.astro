---
import BaseLayout from './BaseLayout.astro';
const { title, description, canonical, schema } = Astro.props;
const site = Astro.site?.toString() || (import.meta.env.SITE_URL ?? 'https://calcsimpler.com');
const url  = new URL(Astro.url.pathname, site).toString();

const faqs = Array.isArray(schema?.faqs)
  ? schema.faqs.map((q) => ({
      '@type': 'Question',
      name: q.question,
      acceptedAnswer: { '@type': 'Answer', text: q.answer }
    }))
  : [];

const graph = [];
graph.push({
  '@type': 'SoftwareApplication',
  name: schema?.title ?? title ?? 'Calculator',
  operatingSystem: 'All',
  applicationCategory: 'Calculator',
  url: url,
  description: schema?.intro ?? description ?? '',
  softwareVersion: '1.0',
  author: { '@type': 'Organization', name: 'CalcSimpler.com' },
  isAccessibleForFree: true
});
if (faqs.length) {
  graph.push({
    '@type': 'FAQPage',
    mainEntity: faqs
  });
}
const jsonLd = { '@context': 'https://schema.org', '@graph': graph };
---
<BaseLayout {title} {description} {canonical}>
  <slot />
  <script type="application/ld+json" is:inline>{JSON.stringify(jsonLd)}</script>
</BaseLayout>
