---
import BaseLayout from '../../layouts/BaseLayout.astro';
import calcs from '../../../data/calculators.json';

const CATEGORIES = [
  { slug: 'finance', map: ['Finance','Finance & Loans','Taxes','Business','Business & Commerce'] },
  { slug: 'health', map: ['Health','Health & Fitness'] },
  { slug: 'conversions', map: ['Conversions','Unit Conversions'] },
  { slug: 'geometry', map: ['Geometry','Areas & Volumes'] },
  { slug: 'algebra', map: ['Algebra','Percentages & Ratios'] },
  { slug: 'time-date', map: ['Time & Date'] },
  { slug: 'statistics', map: ['Statistics'] },
  { slug: 'business', map: ['Business','Business & Commerce','Pricing'] }
];

export async function getStaticPaths() {
  return CATEGORIES.map(c => ({ params: { slug: c.slug }, props: { cat: c } }));
}

const { cat } = Astro.props;
const list = calcs.filter(c => (c.cluster && cat.map.some(v => (c.cluster||'').includes(v)))).slice(0, 200);
---
<BaseLayout title={`${cat.slug} calculators`} description={`Browse ${cat.slug} calculators`}>
  <section class="hero">
    <h1 style="text-transform:capitalize">{cat.slug} Calculators</h1>
    <p>Explore calculators in this category.</p>
  </section>

  {list.length === 0 ? (
    <p class="section">No calculators yet in this category.</p>
  ) : (
    <section class="section">
      <ul class="grid">
        {list.map(c => (
          <li>
            <a class="card" href={`/calculators/${c.slug}/`}>
              <h3>{c.title}</h3>
              <p>{c.intro ?? ''}</p>
            </a>
          </li>
        ))}
      </ul>
    </section>
  )}
</BaseLayout>
